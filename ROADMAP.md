# 🗺️ Kino Development Roadmap

## 开发路线图

本文档记录 Kino 项目的开发进度和待办事项。每次开发前请先查阅此文档，完成后及时更新。

---

## 🎯 当前阶段: Phase 3 - 多资产管理与 UI 最终润色

### 优先级说明
- 🔴 **P0**: 阻塞性功能，必须立即完成
- 🟠 **P1**: 高优先级，影响核心体验
- 🟡 **P2**: 中优先级，重要但不紧急
- 🟢 **P3**: 低优先级，锦上添花

---

## 📋 任务进度摘要

### 1. UI/UX 优化 🔴 P0
- [x] 重设计 Editor UI，完全对标参考图 (Stripe 风格)
- [x] 实现预览区“点击跳转编辑”功能
- [x] 实现 A4 纸张预览格式
- [x] 解决 PDF 导出崩溃问题 (修复 oklch 颜色兼容性)
- [x] 彻底移除硬编码 Logo

### 2. 数据持久化 🔴 P0
- [x] Supabase 数据库集成
- [x] 文档 CRUD
- [x] 自动保存功能 (Debounce 5s)
- [x] 公司设置持久化
- [ ] 多资产 (Logo/签名/印章) 管理表创建 (等待 SQL 执行)

### 3. 用户认证系统 🟠 P1
- [x] Supabase Auth + Google OAuth
- [x] 保护路由中间件
- [x] 登录重定向修复

### 4. PDF 导出功能 🟠 P1
- [x] 修复 `html2canvas` 不支持 `oklch/lab` 颜色的 Bug
- [x] 实现跨域图片预处理 (Data URL 转换)
- [x] 优化多页 PDF 分页逻辑

### 6. 公司设置页面 🟡 P2

#### 6.1 设置页面 UI
- [ ] 创建 `/settings` 路由
- [ ] 公司信息表单
  - [ ] 公司名称
  - [ ] 联系方式
  - [ ] 地址
  - [ ] 税号
- [ ] 品牌资产管理
  - [ ] 默认 Logo
  - [ ] 默认签名
  - [ ] 默认印章
- [ ] 支付信息设置
  - [ ] 银行账户
  - [ ] FPS 信息
  - [ ] PayMe/Alipay (可选)

#### 6.2 模板管理
- [ ] 默认条款模板
- [ ] 备注模板
- [ ] 邮件模板

#### 6.3 设置应用
- [ ] 新建文档时自动填充
- [ ] 设置优先级逻辑
- [ ] 设置导入/导出

### 7. 订阅系统 🟡 P2

#### 7.1 免费额度管理
- [ ] 文档计数逻辑
- [ ] 额度检查中间件
- [ ] 额度用尽提示
- [ ] 升级引导

#### 7.2 Stripe 集成
- [ ] Stripe 账户配置
- [ ] 创建订阅产品
- [ ] Checkout Session
- [ ] 支付成功回调
- [ ] Webhook 处理

#### 7.3 订阅管理
- [ ] 订阅状态追踪
- [ ] 升级/降级流程
- [ ] 取消订阅
- [ ] 发票管理

### 8. 搜索和过滤 🟡 P2

#### 8.1 搜索功能
- [ ] 全文搜索实现
- [ ] 搜索输入框
- [ ] 搜索结果高亮
- [ ] 搜索历史

#### 8.2 过滤器
- [ ] 按文档类型过滤
- [ ] 按状态过滤
- [ ] 按客户过滤
- [ ] 按日期范围过滤

#### 8.3 排序功能
- [ ] 按创建时间排序
- [ ] 按更新时间排序
- [ ] 按金额排序
- [ ] 按客户名排序

### 9. 邮件发送 🟢 P3

#### 9.1 邮件服务集成
- [ ] SendGrid / Resend 配置
- [ ] 邮件模板设计
- [ ] 附件处理 (PDF)

#### 9.2 发送功能
- [ ] 发送文档给客户
- [ ] 抄送自己
- [ ] 发送确认提示

#### 9.3 自动提醒
- [ ] 发票到期提醒
- [ ] 支付确认邮件
- [ ] 收据发送

---

## 🐛 Bug 修复清单

### 高优先级 Bug
- [ ] AI 生成失败时无错误提示
- [ ] 图片上传后刷新页面丢失
- [ ] 支付状态撤销窗口计时不准确
- [ ] 移动端预览区域滚动问题

### 中优先级 Bug
- [ ] 表单验证不完整
- [ ] Tab 切换时状态未保存
- [ ] 长文本溢出问题
- [ ] 日期选择器样式问题

### 低优先级 Bug
- [ ] Console 警告清理
- [ ] TypeScript 类型警告
- [ ] 无障碍性问题

---

## 🔧 技术债务清理

### 代码重构
- [ ] 提取公共组件
  - [ ] FormField 组件
  - [ ] DataTable 组件
  - [ ] EmptyState 组件
- [ ] 状态管理优化
  - [ ] 引入 Zustand/Jotai
  - [ ] 全局状态设计
  - [ ] 持久化状态
- [ ] API 层抽象
  - [ ] 创建 API 服务层
  - [ ] 统一错误处理
  - [ ] 请求拦截器

### 性能优化
- [ ] 图片懒加载
- [ ] 代码分割 (Code Splitting)
- [ ] 组件懒加载 (React.lazy)
- [ ] 预览组件虚拟化
- [ ] AI 请求缓存

### 类型安全
- [ ] 完善所有组件类型定义
- [ ] 移除 `any` 类型
- [ ] 添加严格模式
- [ ] API 响应类型定义

### 测试
- [ ] 单元测试 (Jest + Testing Library)
- [ ] 组件测试
- [ ] E2E 测试 (Playwright)
- [ ] API 测试

---

## 📊 进度追踪

### Phase 2 完成度: 0%

| 模块 | 进度 | 预计完成时间 |
|------|------|-------------|
| UI/UX 优化 | 0% | 2 周 |
| 数据持久化 | 0% | 1 周 |
| 用户认证 | 0% | 3 天 |
| 文档关联 | 0% | 3 天 |
| PDF 导出 | 0% | 2 天 |
| 公司设置 | 0% | 3 天 |
| 订阅系统 | 0% | 1 周 |
| 搜索过滤 | 0% | 2 天 |
| 邮件发送 | 0% | 2 天 |

---

## 🎨 设计参考

### 待提供的参考图片
- [ ] Dashboard 整体布局参考
- [ ] 统计卡片设计参考
- [ ] 编辑器布局参考
- [ ] 文档预览模板参考
- [ ] 移动端设计参考

### 设计资源
- [ ] Logo 设计 (SVG)
- [ ] 图标集 (Lucide Icons)
- [ ] 插图素材
- [ ] 品牌指南

---

## 📝 开发规范

### Git Commit 规范
```
feat: 新功能
fix: Bug 修复
docs: 文档更新
style: 代码格式化
refactor: 重构
perf: 性能优化
test: 测试
chore: 构建/工具链
```

### 分支策略
- `main`: 生产环境
- `develop`: 开发环境
- `feature/*`: 功能分支
- `fix/*`: 修复分支

### Code Review 检查点
- [ ] 代码符合规范
- [ ] 类型定义完整
- [ ] 无 console.log
- [ ] 无硬编码
- [ ] 错误处理完善
- [ ] 性能考虑
- [ ] 可访问性

---

## 🚀 部署计划

### 开发环境
- [ ] Vercel 部署配置
- [ ] 环境变量设置
- [ ] 预览部署

### 生产环境
- [ ] 域名配置
- [ ] SSL 证书
- [ ] CDN 配置
- [ ] 监控告警

---

## 📚 文档更新

### 需要维护的文档
- [x] PRD.md (产品需求文档)
- [x] ROADMAP.md (开发路线图)
- [ ] README.md (项目说明)
- [ ] CONTRIBUTING.md (贡献指南)
- [ ] API.md (API 文档)
- [ ] CHANGELOG.md (更新日志)

---

## 🔄 更新日志

### 2026-01-05
- 创建开发路线图
- 规划 Phase 2 任务
- 定义优先级和时间表

---

**下次更新**: 完成第一个功能模块后  
**负责人**: Johnson  
**最后更新**: 2026-01-05


